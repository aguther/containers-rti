---
# ------------------------------------------------------------------------------
- name: install
  yum:
    name: etcd
    state: latest

# ------------------------------------------------------------------------------
- name: set ETCD_LISTEN_CLIENT_URLS
  command: "sed -i 's/\\(ETCD_LISTEN_CLIENT_URLS=\"\\).*\\(\"\\)/\\1{{ item }}\\2/g' /etc/etcd/etcd.conf"
  with_items: "{{ etcd_listen_client_urls }}"

- name: set ETCD_ADVERTISE_CLIENT_URLS
  command: "sed -i 's/\\(ETCD_ADVERTISE_CLIENT_URLS=\"\\).*\\(\"\\)/\\1{{ item }}\\2/g' /etc/etcd/etcd.conf"
  with_items: "{{ etcd_advertise_client_urls }}"

# ------------------------------------------------------------------------------
- name: enable and start etcd
  service:
    name: etcd.service
    state: restarted
    enabled: yes
...
