---
- name: join nodes
  command: "/usr/bin/kubeadm join --discovery-token-unsafe-skip-ca-verification --token={{ hostvars[groups['master'][0]].kubeadm_token }} {{ hostvars[groups['master'][0]]['ansible_' + kubernetes_interface].ipv4.address }}:6443"
  environment:
    no_proxy: "10.0.0.0/16, 10.96.0.0/16"

# this should only be needed on vagrant boxes
- name: setup route
  command: "route add 10.96.0.1 gw {{ hostvars[groups['master'][0]]['ansible_' + kubernetes_interface].ipv4.address }}"
